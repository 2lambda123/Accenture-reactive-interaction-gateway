<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>API Gateway · Reactive Interaction Gateway</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;RIG includes a basic API Gateway implementation (a configurable, distributed HTTP reverse proxy). Provided a route is configured, RIG will forward any matching HTTP request to the respective service, wait for the reply and forward that reply to the original caller.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="API Gateway · Reactive Interaction Gateway"/><meta property="og:type" content="website"/><meta property="og:url" content="https://accenture.github.io/reactive-interaction-gateway/index.html"/><meta property="og:description" content="&lt;p&gt;RIG includes a basic API Gateway implementation (a configurable, distributed HTTP reverse proxy). Provided a route is configured, RIG will forward any matching HTTP request to the respective service, wait for the reply and forward that reply to the original caller.&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/reactive-interaction-gateway/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/reactive-interaction-gateway/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/reactive-interaction-gateway/"><img class="logo" src="/reactive-interaction-gateway/img/icon.svg" alt="Reactive Interaction Gateway"/><h2 class="headerTitleWithLogo">Reactive Interaction Gateway</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/reactive-interaction-gateway/docs/intro.html" target="_self">User Documentation</a></li><li class=""><a href="/reactive-interaction-gateway/source_docs/index.html" target="_self">Source Documentation</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Main Concepts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/reactive-interaction-gateway/docs/intro.html">Intro</a></li><li class="navListItem"><a class="navItem" href="/reactive-interaction-gateway/docs/tutorial.html">Tutorial</a></li><li class="navListItem"><a class="navItem" href="/reactive-interaction-gateway/docs/faq.html">FAQ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Main Concepts</h3><ul><li class="navListItem navListItemActive"><a class="navItem" href="/reactive-interaction-gateway/docs/api-gateway.html">API Gateway</a></li><li class="navListItem"><a class="navItem" href="/reactive-interaction-gateway/docs/event-subscription.html">Event Subscription</a></li><li class="navListItem"><a class="navItem" href="/reactive-interaction-gateway/docs/user-authentication.html">User authentication</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced Guides</h3><ul><li class="navListItem"><a class="navItem" href="/reactive-interaction-gateway/docs/api-gateway-synchronization.html">API Gateway Synchronization</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">RIG in Production</h3><ul><li class="navListItem"><a class="navItem" href="/reactive-interaction-gateway/docs/rig-ops-guide.html">Operator&#x27;s Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Hacking the Source</h3><ul><li class="navListItem"><a class="navItem" href="/reactive-interaction-gateway/docs/rig-dev-guide.html">Developer&#x27;s Guide</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">API Gateway</h1></header><article><div><span><p>RIG includes a basic API Gateway implementation (a configurable, distributed HTTP reverse proxy). Provided a route is configured, RIG will forward any matching HTTP request to the respective service, wait for the reply and forward that reply to the original caller.</p>
<p>The configuration should be passed at startup. Additionally, RIG provides an API to add, change or remove routes at runtime. These changes are replicated throughout the cluster, but they are not persisted; that is, if all RIG nodes are shut down, any changes to the proxy configuration are lost. Check out the <a href="/reactive-interaction-gateway/docs/api-gateway-synchronization.html">Advanced API documentation</a> to learn more.</p>
<p>To pass the configuration at startup, RIG uses an environment variable called <code>PROXY_CONFIG_FILE</code>. This variable can be used to either pass the <em>path</em> to an existing JSON file, or to directly pass the configuration as a JSON string. Let's configure a simple endpoint to show how this works.</p>
<blockquote>
<p>The configuration JSON (file) holds a list of API definitions. Refer to the <a href="https://github.com/Accenture/reactive-interaction-gateway/blob/master/guides/configuration.md#api-gateway">API documentation</a> for details.</p>
</blockquote>
<p>We define an endpoint configuration like this:</p>
<pre><code class="hljs css language-json">[{
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"my-service"</span>,
  <span class="hljs-attr">"version_data"</span>: {
    <span class="hljs-attr">"default"</span>: {
      <span class="hljs-attr">"endpoints"</span>: [{
        <span class="hljs-attr">"id"</span>: <span class="hljs-string">"my-endpoint"</span>,
        <span class="hljs-attr">"method"</span>: <span class="hljs-string">"GET"</span>,
        <span class="hljs-attr">"path"</span>: <span class="hljs-string">"/"</span>
      }]
    }
  },
  <span class="hljs-attr">"proxy"</span>: {
    <span class="hljs-attr">"use_env"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"target_url"</span>: <span class="hljs-string">"API_HOST"</span>,
    <span class="hljs-attr">"port"</span>: <span class="hljs-number">3000</span>
  }
}]
</code></pre>
<p>This defines a single service called &quot;my-service&quot;. The URL is read from an given environment variable in this case (<code>use_env: true</code>). Because we want to run RIG inside a Docker container, we cannot use <code>localhost</code>. Instead, we can use <code>host.docker.internal</code> within the container to refer to the Docker host. This way, the service URL is resolved to <code>http://host.docker.internal:3000</code>. The service has one endpoint called &quot;my-endpoint&quot; at path <code>/</code>, which forwards <code>GET</code> requests to the same path (<code>http://host.docker.internal:3000/</code>).</p>
<p>As a demo service, we use a small Node.js script:</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">const</span> port = <span class="hljs-number">3000</span>;
<span class="hljs-keyword">const</span> handler = <span class="hljs-function">(<span class="hljs-params">_req, res</span>) =&gt;</span> res.end(<span class="hljs-string">"Hi, I'm a demo service!\n"</span>);
<span class="hljs-keyword">const</span> server = http.createServer(handler);
server.listen(port, err =&gt; {
  <span class="hljs-keyword">if</span> (err) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.error(err);
  }
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`server is listening on <span class="hljs-subst">${port}</span>`</span>);
})
</code></pre>
<p>Using Docker, our configuration can be put into a file and mounted into the container. Also, we set <code>API_HOST</code> to the Docker host URL as mentioned above. On Linux or Mac, this looks like this:</p>
<pre><code class="hljs css language-bash">$ cat &lt;&lt;EOF &gt;config.json
&lt;paste the configuration from above&gt;
EOF
$ docker run \
  -e API_HOST=http://host.docker.internal \
  -v <span class="hljs-string">"<span class="hljs-variable">$(pwd)</span>"</span>/config.json:/config.json \
  -e PROXY_CONFIG_FILE=/config.json \
  -p 4000:4000 -p 4010:4010 \
  -e HTTPS_CERTFILE=cert/selfsigned.pem \
  -e HTTPS_KEYFILE=cert/selfsigned_key.pem \
  accenture/reactive-interaction-gateway
</code></pre>
<p>After that we should be able to reach our small demo service through RIG:</p>
<pre><code class="hljs css language-bash">$ curl localhost:4000
Hi, I<span class="hljs-string">'m a demo service!
</span></code></pre>
<p>Alternatively, instead of using a file we can also pass the configuration directly:</p>
<pre><code class="hljs css language-bash">$ config=<span class="hljs-string">"<span class="hljs-variable">$(cat config.json)</span>"</span>
$ docker run \
  -e API_HOST=http://host.docker.internal \
  -e PROXY_CONFIG_FILE=<span class="hljs-string">"<span class="hljs-variable">$config</span>"</span> \
  -p 4000:4000 -p 4010:4010 \
  -e HTTPS_CERTFILE=cert/selfsigned.pem \
  -e HTTPS_KEYFILE=cert/selfsigned_key.pem \
  accenture/reactive-interaction-gateway
</code></pre>
<p>Note that this way we don't need a Docker volume, which might work better in your environment. Again, we should be able to reach the demo service:</p>
<pre><code class="hljs css language-bash">$ curl localhost:4000
Hi, I<span class="hljs-string">'m a demo service!
</span></code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/reactive-interaction-gateway/docs/faq.html"><span class="arrow-prev">← </span><span>FAQ</span></a><a class="docs-next button" href="/reactive-interaction-gateway/docs/event-subscription.html"><span>Event Subscription</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/reactive-interaction-gateway/" class="nav-home"></a><div><h5>Docs</h5><a href="/reactive-interaction-gateway/docs/en/intro.html">Intro</a><a href="/reactive-interaction-gateway/docs/en/getting-started.html">Getting Started</a></div><div><h5>Community</h5><a href="/reactive-interaction-gateway/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/reactive-interaction-gateway" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://twitter.com/kevnbadr" target="_blank" rel="noreferrer noopener">@KevnBadr</a></div><div><h5>More</h5><a class="github-button" href="https://github.com/accenture/reactive-interaction-gateway" data-icon="octicon-star" data-count-href="/accenture/reactive-interaction-gateway/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star RIG on GitHub">Star RIG on GitHub</a></div></section><section class="copyright">Copyright © 2019 Accenture</section></footer></div></body></html>